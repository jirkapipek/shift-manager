(function(e){function t(t){for(var r,s,i=t[0],u=t[1],c=t[2],l=0,d=[];l<i.length;l++)s=i[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==a[u]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function s(e){return i.p+"js/"+({about:"about"}[e]||e)+"."+{about:"a7bb9e64"}[e]+".js"}function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=s(e);var c=new Error;o=function(t){u.onerror=u.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",c.name="ChunkLoadError",c.type=r,c.request=o,n[1](c)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:u})}),12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var p=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"150b":function(e,t,n){},4360:function(e,t,n){"use strict";var r=n("2b0e"),a=n("2f62"),o=(n("caad"),n("b0c0"),n("2532"),n("96cf"),n("1da1")),s=n("bc3a"),i=n.n(s),u=n("a18c"),c={token:null,user:null},l={SET_TOKEN:function(e,t){e.token=t},SET_USER:function(e,t){e.user=t},register_request:function(e){e.status="loading"},register_success:function(e){e.status="success"},password_request:function(e){e.status="loading"},password_success:function(e){e.status="success"},logout:function(e){e.status="",e.token="",e.user=""}},p={isLoggedIn:function(e){return e.token&&e.user},isAdmin:function(e){return"admin"==e.user.user.role},isManager:function(e){return"manager"==e.user.user.role},isEmployee:function(e){return"employee"==e.user.user.role},user:function(e){return e.user}},d={login:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.dispatch,n.next=3,i.a.post("/api/users/login",t);case 3:return a=n.sent,n.abrupt("return",r("attempt",a.data.token));case 5:case"end":return n.stop()}}),n)})))()},attempt:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,a=e.state,t&&r("SET_TOKEN",t),a.token){n.next=4;break}return n.abrupt("return");case 4:return r("SET_TOKEN",t),n.prev=5,n.next=8,i.a.get("/api/users/me");case 8:o=n.sent,r("SET_USER",o.data),n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](5),r("SET_TOKEN",null),r("SET_USER",null);case 16:case"end":return n.stop()}}),n,null,[[5,12]])})))()},register:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,r("register_request"),n.next=4,i.a.post("/api/users/register",t);case 4:return a=n.sent,void 0!==a.data.success&&r("register_success"),n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})))()},changePin:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,r("password_request"),n.next=4,i.a.post("/api/users/changepassword",t);case 4:return a=n.sent,void 0!==a.data.success&&r("password_success"),n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})))()},logout:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,r("SET_TOKEN",null),r("SET_USER",null),u["a"].push({path:"login",query:{msg:t}}).catch((function(e){"NavigationDuplicated"===e.name||e.message.includes("Avoided redundant navigation to current location")||console.log(e)})),n.abrupt("return");case 5:case"end":return n.stop()}}),n)})))()}},m={state:c,actions:d,mutations:l,getters:p};r["default"].use(a["a"]);t["a"]=new a["a"].Store({modules:{Auth:m},state:{},mutations:{},actions:{}})},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("0cdd");var r=n("2b0e"),a=n("5f5b");n("ab8b"),n("2dd8");r["default"].use(a["a"]);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("Navbar")],1),n("router-view"),n("Footer")],1)},s=[],i=(n("d3b7"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[n("b-navbar-brand",{attrs:{to:"/"}},[e._v("ShiftManager")]),e.isLoggedIn?n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}):e._e(),e.isLoggedIn?n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[e.isLoggedIn?n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" Shifts ")]},proxy:!0}],null,!1,1842224732)},[e.isEmployee?n("b-dropdown-item",{attrs:{to:"/requests",exact:"","exact-active-class":"active"}},[e._v("My requests")]):e._e(),e.isEmployee?n("b-dropdown-item",{attrs:{to:"/shifts",exact:"","exact-active-class":"active"}},[e._v("My shifts")]):e._e(),e.isAdmin||e.isManager?n("b-dropdown-item",{attrs:{to:"/mngrequests",exact:"","exact-active-class":"active"}},[e._v("Shift requests")]):e._e(),e.isAdmin||e.isManager?n("b-dropdown-item",{attrs:{to:"/mngshifts"}},[e._v("All shifts")]):e._e()],1):e._e(),e.isLoggedIn&&(e.isAdmin||e.isManager)?n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" Employees ")]},proxy:!0}],null,!1,3614101854)},[n("b-dropdown-item",{attrs:{to:"/employees",exact:"","exact-active-class":"active"}},[e._v("All employees")]),n("b-dropdown-item",{attrs:{to:"/register",exact:"","exact-active-class":"active"}},[e._v("Register emploeyee")])],1):e._e(),e.isLoggedIn&&(e.isAdmin||e.isManager)?n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" Settings ")]},proxy:!0}],null,!1,1340434538)},[n("b-dropdown-item",{attrs:{to:"/workingtimes",exact:"","exact-active-class":"active"}},[e._v("Working times")]),n("b-dropdown-item",{attrs:{to:"/positions",exact:"","exact-active-class":"active"}},[e._v("Positions")])],1):e._e(),e.isLoggedIn?n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("em",[n("b-avatar",{attrs:{size:"1.5em"}}),e._v(" - "+e._s(e.user.user.name+" "+e.user.user.lastname))],1)]},proxy:!0}],null,!1,3523681704)},[n("b-dropdown-item",{attrs:{to:"/profile",exact:"","exact-active-class":"active"}},[e._v("Profile")]),n("b-dropdown-item",{attrs:{to:"/changepassword",exact:"","exact-active-class":"active"}},[e._v("Change password")]),n("b-dropdown-item",{attrs:{to:"/logout"},on:{click:function(t){return t.preventDefault(),e.logoutUser(t)}}},[e._v("Log out")])],1):e._e()],1)],1):e._e()],1)],1)}),u=[],c=n("5530"),l=n("2f62"),p={data:function(){return{name:"",lastname:"",email:""}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(l["c"])(["isLoggedIn"])),Object(l["c"])(["user"])),Object(l["c"])(["isAdmin"])),Object(l["c"])(["isManager"])),Object(l["c"])(["isEmployee"])),methods:Object(c["a"])(Object(c["a"])({},Object(l["b"])(["logout"])),{},{logoutUser:function(){this.logout()}})},d=p,m=n("2877"),f=Object(m["a"])(d,i,u,!1,null,null,null),g=f.exports,b=n("bc3a"),h=n.n(b),v=n("4360"),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"footer"},[e._v(" Studentský projekt TNPW2 - Jiří Pipek 2021 ")])},_=[],y=(n("8a56"),{}),x=Object(m["a"])(y,w,_,!1,null,"551b59d2",null),O=x.exports,k={components:{Navbar:g,Footer:O},watch:{$route:function(e){document.title=e.meta.title||"Your Website"}},created:function(){h.a.interceptors.response.use(void 0,(function(e){return new Promise((function(){throw 401===e.response.status&&e.config&&!e.config.__isRetryRequest&&v["a"].dispatch("logout","Your password expired, Please log in again!"),e}))}))}},E=k,S=Object(m["a"])(E,o,s,!1,null,null,null),j=S.exports,q=n("a18c");n("150b");n("66c6"),r["default"].config.productionTip=!1,v["a"].dispatch("attempt",localStorage.getItem("token")).then((function(){new r["default"]({router:q["a"],store:v["a"],render:function(e){return e(j)}}).$mount("#app")}))},6307:function(e,t,n){},"66c6":function(e,t,n){"use strict";n.r(t);var r=n("4360"),a=n("bc3a"),o=n.n(a);r["a"].subscribe((function(e){switch(e.type){case"SET_TOKEN":e.payload?(o.a.defaults.headers.common["Authorization"]=e.payload,localStorage.setItem("token",e.payload)):(o.a.defaults.headers.common["Authorization"]=null,localStorage.removeItem("token"));break}}))},"8a56":function(e,t,n){"use strict";var r=n("6307"),a=n.n(r);a.a},a18c:function(e,t,n){"use strict";n("45fc"),n("d3b7");var r=n("2b0e"),a=n("8c4f"),o=n("4360");r["default"].use(a["a"]);var s=[{path:"*",component:function(){return n.e("about").then(n.bind(null,"9703"))}},{path:"/",name:"login",meta:{title:"Log in",requiresGuest:!0},component:function(){return n.e("about").then(n.bind(null,"a55b"))}},{path:"/login",name:"Login",meta:{title:"Log in",requiresGuest:!0},component:function(){return n.e("about").then(n.bind(null,"a55b"))}},{path:"/register",name:"Register",meta:{title:"Register employee",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"73cf"))}},{path:"/profile",name:"Profile",meta:{title:"My profile",requiresAuth:!0},component:function(){return n.e("about").then(n.bind(null,"c66d"))}},{path:"/employees",name:"Employees",meta:{title:"All empoloyees",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"cb29"))}},{path:"/workingtimes",name:"Working Times",meta:{title:"All working times",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"a9f6"))}},{path:"/positions",name:"Job positons",meta:{title:"All job positions",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"6507"))}},{path:"/requests",name:"Shift requests",meta:{title:"Shift requests",requiresEmployee:!0},component:function(){return n.e("about").then(n.bind(null,"375b"))}},{path:"/shifts",name:"Shifts",meta:{title:"Shifts",requiresEmployee:!0},component:function(){return n.e("about").then(n.bind(null,"0918"))}},{path:"/mngrequests",name:"Manage requests",meta:{title:"Manage shift requests",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"34cc"))}},{path:"/mngshifts",name:"Manage shifts",meta:{title:"Manage shifts",requiresManager:!0},component:function(){return n.e("about").then(n.bind(null,"ff07"))}},{path:"/changepassword",name:"Change password",meta:{title:"Change password",requiresAuth:!0},component:function(){return n.e("about").then(n.bind(null,"0060"))}}],i=new a["a"]({routes:s});i.beforeEach((function(e,t,n){e.matched.some((function(e){return e.meta.requiresAuth}))?o["a"].getters.isLoggedIn?n():n("/login"):e.matched.some((function(e){return e.meta.requiresGuest}))?o["a"].getters.isLoggedIn?n("/profile"):n():e.matched.some((function(e){return e.meta.requiresManager}))?o["a"].getters.isLoggedIn&&(o["a"].getters.isAdmin||o["a"].getters.isManager)?n():n("/login"):e.matched.some((function(e){return e.meta.requiresEmployee}))?o["a"].getters.isLoggedIn&&"employee"==o["a"].getters.user.user.role?n():n("/profile"):n()})),t["a"]=i}});
//# sourceMappingURL=app.0bce4bda.js.map